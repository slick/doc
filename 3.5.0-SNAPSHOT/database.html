<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Database Configuration · Slick</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='Scala Slick documentation'/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<script type="text/javascript" src="js/warnOldVersion.js"></script>
<script type="text/javascript" src="js/groups.js"></script>
<script type="text/javascript" src="js/snippets.js"></script>
<link rel="stylesheet" type="text/css" href="lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="css/page.css"/>
<link rel="shortcut icon" href="images/favicon.ico" />
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="index.html" >
<span class="home-icon">⌂</span>Slick
</a>
<div class="version-number">
<ul class="menu version-menu" data-options="disableHover: true; clickOpen: true; closeOnClickInside: false;">
<li class="is-dropdown-submenu-parent">
<a href="#">
3.5.0-pre.114.9f775441
</a>
<ul class="menu">
</ul>
</li>
</ul>
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="introduction.html" class="page">Introduction</a></li>
  <li><a href="supported-databases.html" class="page">Supported Databases</a></li>
  <li><a href="gettingstarted.html" class="page">Getting Started</a></li>
  <li><a href="concepts.html" class="page">Core Concepts</a></li>
  <li><a href="database.html" class="active page">Database Configuration</a></li>
  <li><a href="dbio.html" class="page">Database I/O Actions</a></li>
  <li><a href="schemas.html" class="page">Schemas</a>
  <ul>
    <li><a href="datetimetypes.html" class="page">Date and Time types</a></li>
  </ul></li>
  <li><a href="queries.html" class="page">Queries</a></li>
  <li><a href="code-generation.html" class="page">Schema Code Generation</a></li>
  <li><a href="userdefined.html" class="page">User-Defined Features</a></li>
  <li><a href="sql.html" class="page">Plain SQL Queries</a></li>
  <li><a href="orm-to-slick.html" class="page">Coming from ORM to Slick</a></li>
  <li><a href="sql-to-slick.html" class="page">Coming from SQL to Slick</a></li>
  <li><a href="cookbook.html" class="page">Cookbook</a></li>
  <li><a href="upgrade.html" class="page">Upgrade Guides</a>
  <ul>
    <li><a href="compat-report.html" class="page">Incompatible changes</a></li>
  </ul></li>
  <li><a href="migrations.html" class="page">Database Migrations</a></li>
  <li><a href="testkit.html" class="page">Slick TestKit</a></li>
  <li><a href="documentation.html" class="page">Markdown Documentation</a></li>
  <li><a href="config.html" class="page">Configuration</a></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title"><a href="index.html">Slick</a></div>

<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="index.html" >
<span class="home-icon">⌂</span>Slick
</a>
<div class="version-number">
<ul class="menu version-menu" data-options="disableHover: true; clickOpen: true; closeOnClickInside: false;">
<li class="is-dropdown-submenu-parent">
<a href="#">
3.5.0-pre.114.9f775441
</a>
<ul class="menu">
</ul>
</li>
</ul>
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="introduction.html" class="page">Introduction</a></li>
  <li><a href="supported-databases.html" class="page">Supported Databases</a></li>
  <li><a href="gettingstarted.html" class="page">Getting Started</a></li>
  <li><a href="concepts.html" class="page">Core Concepts</a></li>
  <li><a href="database.html" class="active page">Database Configuration</a></li>
  <li><a href="dbio.html" class="page">Database I/O Actions</a></li>
  <li><a href="schemas.html" class="page">Schemas</a>
  <ul>
    <li><a href="datetimetypes.html" class="page">Date and Time types</a></li>
  </ul></li>
  <li><a href="queries.html" class="page">Queries</a></li>
  <li><a href="code-generation.html" class="page">Schema Code Generation</a></li>
  <li><a href="userdefined.html" class="page">User-Defined Features</a></li>
  <li><a href="sql.html" class="page">Plain SQL Queries</a></li>
  <li><a href="orm-to-slick.html" class="page">Coming from ORM to Slick</a></li>
  <li><a href="sql-to-slick.html" class="page">Coming from SQL to Slick</a></li>
  <li><a href="cookbook.html" class="page">Cookbook</a></li>
  <li><a href="upgrade.html" class="page">Upgrade Guides</a>
  <ul>
    <li><a href="compat-report.html" class="page">Incompatible changes</a></li>
  </ul></li>
  <li><a href="migrations.html" class="page">Database Migrations</a></li>
  <li><a href="testkit.html" class="page">Slick TestKit</a></li>
  <li><a href="documentation.html" class="page">Markdown Documentation</a></li>
  <li><a href="config.html" class="page">Configuration</a></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<span id="version-warning"></span>

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="index.html">Slick</a></li>
  <li>Database Configuration</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#database-configuration" name="database-configuration" class="anchor"><span class="anchor-link"></span></a>Database Configuration</h1>
<p>You can tell Slick how to connect to the JDBC database of your choice by creating a <a href="https://scala-slick.org/doc/3.5.0-SNAPSHOT/api/slick/jdbc/JdbcBackend.html#Database:Database" title="slick.jdbc.JdbcBackend"><code>Database</code></a> object, which encapsulates the information. There are several <a href="https://scala-slick.org/doc/3.5.0-SNAPSHOT/api/slick/jdbc/JdbcBackend$DatabaseFactoryDef.html" title="slick.jdbc.JdbcBackend$DatabaseFactoryDef"><code>factory methods</code></a> on <code>slick.jdbc.JdbcBackend.Database</code> that you can use depending on what connection data you have available.</p>
<h2><a href="#using-typesafe-config" name="using-typesafe-config" class="anchor"><span class="anchor-link"></span></a>Using Typesafe Config</h2>
<p>The preferred way to configure database connections is through <a href="https://github.com/lightbend/config">Typesafe Config</a> in your <code>application.conf</code>, which is also used by <a href="https://www.playframework.com/">Play</a> and <a href="https://akka.io/">Akka</a> for their configuration.</p>
<p>Such a configuration can be loaded with <code>Database.forConfig</code> (see the <a href="https://scala-slick.org/doc/3.5.0-SNAPSHOT/api/slick/jdbc/JdbcBackend$DatabaseFactoryDef.html#forConfig(String,Config,Driver,ClassLoader):Database" title="slick.jdbc.JdbcBackend$DatabaseFactoryDef"><code>API documentation</code></a> of this method for details on the configuration parameters).</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/code/Connection.scala#L47" target="_blank" title="Go to snippet source">source</a><code class="language-scala">val db = Database.forConfig(&quot;mydb&quot;)</code></pre>
<h4><a href="#examples" name="examples" class="anchor"><span class="anchor-link"></span></a>Examples</h4>
<h5><a href="#postgresql" name="postgresql" class="anchor"><span class="anchor-link"></span></a>PostgreSQL</h5>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/code/application.conf#L11-L22" target="_blank" title="Go to snippet source">source</a><code class="language-conf">mydb = {
  connectionPool = &quot;HikariCP&quot; //use HikariCP for our connection pool
  dataSourceClass = &quot;org.postgresql.ds.PGSimpleDataSource&quot; //Simple datasource with no connection pooling. The connection pool has already been specified with HikariCP.
  properties = {
    serverName = &quot;localhost&quot;
    portNumber = &quot;5432&quot;
    databaseName = &quot;mydb&quot;
    user = &quot;postgres&quot;
    password = &quot;postgres&quot;
  }
  numThreads = 10
}</code></pre>
<p>When specifying a dataSourceClass you will need to bring in the sbt dependency for that class. The following is an example for the <code>org.postgresql.ds.PGSimpleDataSource</code> data source class:</p>
<pre class="prettyprint"><code class="language-scala">libraryDependencies ++= Seq(
  &quot;com.typesafe.slick&quot; %% &quot;slick&quot; % &quot;3.5.0-pre.114.9f775441&quot;,
  &quot;org.slf4j&quot; % &quot;slf4j-nop&quot; % &quot;1.7.26&quot;,
  &quot;com.typesafe.slick&quot; %% &quot;slick-hikaricp&quot; % &quot;3.5.0-pre.114.9f775441&quot;,
  &quot;org.postgresql&quot; % &quot;postgresql&quot; % &quot;42.2.5&quot; //org.postgresql.ds.PGSimpleDataSource dependency
)
</code></pre>
<p>Note, some examples on the internet point to the 9.4.X versions of the PostgreSQL JDBC drivers. Those examples are incorrect and many years out of date. The 42.X development line has been the main line of development since February 2017. As noted on the Postgres site, &ldquo;Unless you have unusual requirements (running old applications or JVMs), this is the driver you should be using.&rdquo; See <a href="https://jdbc.postgresql.org/download.html">https://jdbc.postgresql.org/download.html</a> for more information about when you may want to use the 9.4 line.</p>
<h5><a href="#mysql" name="mysql" class="anchor"><span class="anchor-link"></span></a>MySQL</h5>
<p>Very simple example without a connection pool and using the driver directly:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/code/application.conf#L26-L32" target="_blank" title="Go to snippet source">source</a><code class="language-conf">mydb = {
  driver = &quot;com.mysql.cj.jdbc.Driver&quot;,
  url = &quot;jdbc:mysql://127.0.0.1:3306/mydb?serverTimezone=UTC&quot;,
  user = &quot;user&quot;,
  password = &quot;pass&quot;,
  connectionPool = disabled
}</code></pre>
<p>To use the MySQL driver, the following library dependency needs to be configured via SBT:</p>
<pre class="prettyprint"><code class="language-scala">libraryDependencies += &quot;com.mysql&quot; % &quot;mysql-connector-j&quot; % &quot;8.0.33&quot;
</code></pre>
<h5><a href="#generic-jdbc" name="generic-jdbc" class="anchor"><span class="anchor-link"></span></a>Generic JDBC</h5>
<p>Sometimes a database system provides a JDBC driver, but no specific profile for its dialect has been implemented for Slick, yet. It is still possible to connect to such a database with not much effort and use the generic JDBC feature set.</p>
<p>Here is an example for setting up a connection to a Databricks DB using the Databricks JDBC driver, depended on via SBT:</p>
<pre class="prettyprint"><code class="language-scala">libraryDependencies += &quot;com.databricks&quot; % &quot;databricks-jdbc&quot; % &quot;2.6.29&quot;
</code></pre>
<p>To configure the connection a profile implementation is required. It is sufficient to extend the <code>JdbcProfile</code> trait with an empty object.</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/code/GenericJdbcProfile.scala#L2-L6" target="_blank" title="Go to snippet source">source</a><code class="language-scala">package com.typesafe.slick.docs

import slick.jdbc.{JdbcActionComponent, JdbcProfile}

object GenericJdbcProfile extends JdbcProfile with JdbcActionComponent.MultipleRowsPerStatementSupport</code></pre>
<p>Now this profile can be used in the configuration.</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/code/application.conf#L67-L76" target="_blank" title="Go to snippet source">source</a><code class="language-conf">databricks_db {
  profile = &quot;com.typesafe.slick.docs.GenericJdbcProfile$&quot;
  db {
    driver = &quot;com.databricks.client.jdbc.Driver&quot;
    url = &quot;jdbc:databricks://DATABRICKS_HOST:443;HttpPath=/sql/1.0/endpoints/XXXXXXXXX;TransportMode=http;SSL=1&quot;
    PWD = &quot;????????????&quot;
    UID = &quot;token&quot;
    AuthMech = &quot;3&quot;
  }
}</code></pre>
<p>Connection parameters for database systems can differ significantly. Please refer to the respective documentation.</p>
<h2><a href="#using-a-jdbc-url" name="using-a-jdbc-url" class="anchor"><span class="anchor-link"></span></a>Using a JDBC URL</h2>
<p>You can pass a JDBC URL to <a href="https://scala-slick.org/doc/3.5.0-SNAPSHOT/api/slick/jdbc/JdbcBackend$DatabaseFactoryDef.html#forURL(String,String,String,Properties,String,AsyncExecutor,Boolean,ClassLoader):DatabaseDef" title="slick.jdbc.JdbcBackend$DatabaseFactoryDef"><code>forURL</code></a>. (see your database&rsquo;s JDBC driver&rsquo;s documentation for the correct URL syntax).</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/code/Connection.scala#L53-L54" target="_blank" title="Go to snippet source">source</a><code class="language-scala">val db = Database.forURL(&quot;jdbc:h2:mem:test1;DB_CLOSE_DELAY=-1&quot;,
  driver=&quot;org.h2.Driver&quot;)</code></pre>
<p>Here we are connecting to a new, empty, in-memory H2 database called <code>test1</code> and keep it resident until the JVM ends (<code>DB_CLOSE_DELAY=-1</code>, which is H2 specific).</p>
<h2><a href="#using-a-database-url" name="using-a-database-url" class="anchor"><span class="anchor-link"></span></a>Using a Database URL</h2>
<p>A Database URL, a platform independent URL in the form <code>vendor://user:password@host:port/db</code>, is often provided by platforms such as Heroku. You can use a Database URL in Typesafe Config as shown here:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/code/application.conf#L47-L53" target="_blank" title="Go to snippet source">source</a><code class="language-conf">databaseUrl {
  dataSourceClass = &quot;slick.jdbc.DatabaseUrlDataSource&quot;
  properties = {
    driver = &quot;org.postgresql.Driver&quot;
    url = &quot;postgres://user:pass@host/dbname&quot;
  }
}</code></pre>
<p>By default, the data source will use the value of the <code>DATABASE_URL</code> environment variable. Thus you may omit the <code>url</code> property if the <code>DATABASE_URL</code> environment variable is set. You may also define a custom environment variable with standard Typesafe Config syntax, such as <code>${?MYSQL_DATABASE_URL}</code>.</p>
<p>Or you may pass a <a href="https://scala-slick.org/doc/3.5.0-SNAPSHOT/api/slick/jdbc/DatabaseUrlDataSource.html" title="slick.jdbc.DatabaseUrlDataSource"><code>DatabaseUrlDataSource</code></a> object to <a href="https://scala-slick.org/doc/3.5.0-SNAPSHOT/api/slick/jdbc/JdbcBackend$DatabaseFactoryDef.html#forDataSource(DataSource,Option[Int],AsyncExecutor,Boolean):DatabaseDef" title="slick.jdbc.JdbcBackend$DatabaseFactoryDef"><code>forDataSource</code></a> .</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/code/Connection.scala#L34-L35" target="_blank" title="Go to snippet source">source</a><code class="language-scala">val db = Database.forDataSource(dataSource: slick.jdbc.DatabaseUrlDataSource,
  None)</code></pre>
<h2><a href="#using-a-datasource" name="using-a-datasource" class="anchor"><span class="anchor-link"></span></a>Using a DataSource</h2>
<p>You can pass a <a href="https://docs.oracle.com/javase/8/docs/api/?javax/sql/DataSource.html" title="javax.sql.DataSource"><code>DataSource</code></a> object to <a href="https://scala-slick.org/doc/3.5.0-SNAPSHOT/api/slick/jdbc/JdbcBackend$DatabaseFactoryDef.html#forDataSource(DataSource,Option[Int],AsyncExecutor,Boolean):DatabaseDef" title="slick.jdbc.JdbcBackend$DatabaseFactoryDef"><code>forDataSource</code></a>. If you got it from the connection pool of your application framework, this plugs the pool into Slick. If the pool has a size limit, the correct size should always be specified.</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/code/Connection.scala#L27-L28" target="_blank" title="Go to snippet source">source</a><code class="language-scala">val db = Database.forDataSource(dataSource: javax.sql.DataSource,
  Some(size: Int))</code></pre>
<h2><a href="#using-a-jndi-name" name="using-a-jndi-name" class="anchor"><span class="anchor-link"></span></a>Using a JNDI Name</h2>
<p>If you are using <a href="https://en.wikipedia.org/wiki/">JNDI</a> you can pass a JNDI name to <a href="https://scala-slick.org/doc/3.5.0-SNAPSHOT/api/slick/jdbc/JdbcBackend$DatabaseFactoryDef.html#forName(String,Option[Int],AsyncExecutor):DatabaseDef" title="slick.jdbc.JdbcBackend$DatabaseFactoryDef"><code>forName</code></a> under which a <a href="https://docs.oracle.com/javase/8/docs/api/?javax/sql/DataSource.html" title="javax.sql.DataSource"><code>DataSource</code></a> object can be looked up. If the data source has a limit in the number of connections it can provide, the correct size should always be specified.</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/code/Connection.scala#L42" target="_blank" title="Go to snippet source">source</a><code class="language-scala">val db = Database.forName(jndiName: String, Some(size: Int))</code></pre>
<h2><a href="#database-thread-pool" name="database-thread-pool" class="anchor"><span class="anchor-link"></span></a>Database thread pool</h2>
<p>Every <code>Database</code> contains an <a href="https://scala-slick.org/doc/3.5.0-SNAPSHOT/api/slick/util/AsyncExecutor.html" title="slick.util.AsyncExecutor"><code>AsyncExecutor</code></a> that manages the thread pool for asynchronous execution of Database I/O Actions. Its size is the main parameter to tune for the best performance of the <code>Database</code> object. It should be set to the value that you would use for the size of the <em>connection pool</em> in a traditional, blocking application (see <a href="https://github.com/brettwooldridge/HikariCP/wiki/About-Pool-Sizing">About Pool Sizing</a> in the <a href="https://github.com/brettwooldridge/HikariCP">HikariCP</a> documentation for further information). When using <a href="https://scala-slick.org/doc/3.5.0-SNAPSHOT/api/slick/jdbc/JdbcBackend$DatabaseFactoryDef.html#forConfig(String,Config,Driver,ClassLoader):Database" title="slick.jdbc.JdbcBackend$DatabaseFactoryDef"><code>Database.forConfig</code></a>, the thread pool is configured directly in the external configuration file together with the connection parameters. If you use any other factory method to get a <code>Database</code>, you can either use a default configuration or specify a custom AsyncExecutor:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/code/Connection.scala#L60-L62" target="_blank" title="Go to snippet source">source</a><code class="language-scala">val db = Database.forURL(&quot;jdbc:h2:mem:test1;DB_CLOSE_DELAY=-1&quot;,
  driver=&quot;org.h2.Driver&quot;,
  executor = AsyncExecutor(&quot;test1&quot;, numThreads=10, queueSize=1000))</code></pre>
<h2><a href="#connection-pools" name="connection-pools" class="anchor"><span class="anchor-link"></span></a>Connection pools</h2>
<p>When using a connection pool (which is always recommended in production environments) the <em>minimum</em> size of the <em>connection pool</em> should also be set to at least the same size. The <em>maximum</em> size of the <em>connection pool</em> can be set much higher than in a blocking application. Any connections beyond the size of the <em>thread pool</em> will only be used when other connections are required to keep a database session open (e.g. while waiting for the result from an asynchronous computation in the middle of a transaction) but are not actively doing any work on the database.</p>
<p>Note that reasonable defaults for the connection pool sizes are calculated from the thread pool size when using <a href="https://scala-slick.org/doc/3.5.0-SNAPSHOT/api/slick/jdbc/JdbcBackend$DatabaseFactoryDef.html#forConfig(String,Config,Driver,ClassLoader):Database" title="slick.jdbc.JdbcBackend$DatabaseFactoryDef"><code>Database.forConfig</code></a>.</p>
<p>Slick uses <em>prepared</em> statements wherever possible but it does not cache them on its own. You should therefore enable prepared statement caching in the connection pool&rsquo;s configuration.</p>
<h2><a href="#databaseconfig" name="databaseconfig" class="anchor"><span class="anchor-link"></span></a>DatabaseConfig</h2><div class="callout note "><div class="callout-title">Note</div>
<p>This section is based on the <a href="https://github.com/slick/slick-multidb"><strong>MultiDB</strong> sample</a> which provides ready-to-run apps to demonstrate the features.</p></div>
<p>On top of the configuration syntax for <code>Database</code>, there is another layer in the form of <a href="https://scala-slick.org/doc/3.5.0-SNAPSHOT/api/slick/basic/DatabaseConfig.html" title="slick.basic.DatabaseConfig"><code>DatabaseConfig</code></a> which allows you to configure a Slick profile plus a matching <code>Database</code> together. This makes it easy to abstract over different kinds of database systems by simply changing a configuration file.</p>
<p>You can see it in action in <code>SimpleExample.scala</code>. First we load the DatabaseConfig and then import the Slick API from its profile:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/paradox/samples/slick-multidb/src/main/scala/databaseconfig/SimpleExample.scala#L11-L14" target="_blank" title="Go to snippet source">source</a><code class="language-scala">val dc = DatabaseConfig.forConfig[JdbcProfile](&quot;h2_dc&quot;)

// Import the JdbcProfile API from the configured profile
import dc.profile.api._</code></pre>
<p>The <code>JdbcProfile</code> type annotation specifies the profile level whose API you get. You have to configure a profile of a matching type in the external configuration file. Since we&rsquo;re using the basic <code>forConfig</code> method with only a path (&ldquo;h2_dc&rdquo;), the configuration must be located in the global application config, usually found in <code>application.conf</code>:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/paradox/samples/slick-multidb/src/main/resources/application.conf#L16-L24" target="_blank" title="Go to snippet source">source</a><code class="language-conf">h2_dc {
  profile = &quot;slick.jdbc.H2Profile$&quot;
  db {
    url = &quot;jdbc:h2:mem:test1&quot;
    driver = org.h2.Driver
    connectionPool = disabled
    keepAliveConnection = true
  }
}</code></pre>
<p>You can use different database systems in your application by either switching out or overriding the application config (e.g. different <code>application.conf</code> files for development and production) or by passing a config path into the application. This way of implementing multi-database support is also used when building a Play app with Slick.</p>
<h2><a href="#other-multi-db-patterns" name="other-multi-db-patterns" class="anchor"><span class="anchor-link"></span></a>Other Multi-DB Patterns</h2><div class="callout note "><div class="callout-title">Note</div>
<p>This section is based on the <a href="https://github.com/slick/slick-multidb"><strong>MultiDB</strong> sample</a> which provides ready-to-run apps to demonstrate the features.</p></div>
<p>Since its addition in Slick 3.0 <code>DatabaseConfig</code> (see <a href="#databaseconfig">above</a>) is the recommended solution. More complex scenarios (for example, where you need to map custom functions differently for different database systems, or where you cannot use the simple application.conf syntax) may require abstracting over databases in Scala code. The following sections explain two different ways of accomplishing this.</p>
<h3><a href="#a-dao-class" name="a-dao-class" class="anchor"><span class="anchor-link"></span></a>A DAO Class</h3>
<p>We start with a simple DAO (data access object) class, <code>DAO.scala</code>. It contains some database-related definitions (for a <code>PROPS</code> table that acts as a simple key/value store) and methods (for storing and reading entries).</p>
<p>The class is parameterized by a concrete <code>JdbcProfile</code> and it imports all API features from this profile&rsquo;s api object:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/paradox/samples/slick-multidb/src/main/scala/basic/DAO.scala#L8-L10" target="_blank" title="Go to snippet source">source</a><code class="language-scala">class DAO(val profile: JdbcProfile) {
  // Import the Scala API from the profile
  import profile.api._</code></pre>
<p>Slick has multiple abstract profiles but in most cases you will want to use <code>JdbcProfile</code> which contains all the features that you also get when importing directly from one of Slick&rsquo;s concrete profiles for JDBC databases.</p>
<p>Outside of the DAO class, you can still refer to its profile and the other features, but you have to get the imports from the profile in order to work with queries. This can be seen in <code>DAOHelper.scala</code>. It defines a new method <code>restrictKey</code> which we could have also put directly into the DAO class.</p>
<p>To gain access to all of the profile&rsquo;s features, we parameterize the <code>DAOHelper</code> with the <code>DAO</code> and import from its profile:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/paradox/samples/slick-multidb/src/main/scala/basic/DAOHelper.scala#L7-L12" target="_blank" title="Go to snippet source">source</a><code class="language-scala">class DAOHelper(val dao: DAO) {
  import dao.profile.api._

  def restrictKey[C[_]](s: String, q: Query[DAO#Props, _, C]) =
    q.filter(_.key === s)
}</code></pre>
<p>Note the use of the type projection <code>DAO#Props</code> in the definition of <code>restrictKey</code>. This points to the <code>Props</code> type coming from any <code>DAO</code> instance. This is less type-safe than using a path-dependent type like <code>dao.Props</code> but generally easier to use. You still need to ensure not to mix drivers when you do this.</p>
<p>We are using the <code>DAO</code> and <code>DAOHelper</code> in <code>MultiDBExample.scala</code>. The <code>run</code> method is parameterized with both, a Slick profile and a matching JDBC <code>Database</code>:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/paradox/samples/slick-multidb/src/main/scala/basic/MultiDBExample.scala#L15-L17" target="_blank" title="Go to snippet source">source</a><code class="language-scala">def run(dao: DAO, db: Database): Future[Unit] = {
  val h = new DAOHelper(dao)
  println(&quot;Using profile &quot; + dao.profile)</code></pre>
<p>Since we don&rsquo;t have the convenience of a single profile&rsquo;s <code>api._</code> import at this point, we need to import the <code>Database</code> and <code>DBIO</code> types directly:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/paradox/samples/slick-multidb/src/main/scala/basic/MultiDBExample.scala#L6-L7" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import slick.dbio.DBIO
import slick.jdbc.JdbcBackend.Database</code></pre>
<p>In the body of <code>MultiDBExample</code>, we create two <code>DAO</code> instances with matching <code>Database</code> objects in order to run the same code on both, H2 and SQLite:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/paradox/samples/slick-multidb/src/main/scala/basic/MultiDBExample.scala#L30-L36" target="_blank" title="Go to snippet source">source</a><code class="language-scala">val f = {
  val h2db = Database.forConfig(&quot;h2&quot;)
  run(new DAO(H2Profile), h2db).andThen { case _ =&gt; h2db.close }
}.flatMap { _ =&gt;
  val sqlitedb = Database.forConfig(&quot;sqlite&quot;)
  run(new DAO(SQLiteProfile), sqlitedb).andThen { case _ =&gt; sqlitedb.close }
}</code></pre>
<h3><a href="#the-cake-pattern" name="the-cake-pattern" class="anchor"><span class="anchor-link"></span></a>The Cake Pattern</h3>
<p>In more complex designs where you want to split up the database code into separate modules that deal with different database entities, but still have dependencies between these modules, you can use the Cake Pattern to structure your code.</p>
<p>We are doing this here in the app <code>MultiDBCakeExample.scala</code>. From the point of view of this main app, the new approach looks exactly like the previous one: You create a DAL (data access layer) object with a Slick profile, and use it together with a matching <code>Database</code>.</p>
<p>The most basic slice of the cake is the <code>ProfileComponent</code>. It provides a <code>JdbcProfile</code> which is kept abstract at this point:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/paradox/samples/slick-multidb/src/main/scala/cake/ProfileComponent.scala" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import slick.jdbc.JdbcProfile

/** The slice of the cake which provides the Slick profile */
trait ProfileComponent {
  val profile: JdbcProfile
}</code></pre>
<p>Through the use of a self-type, the <code>PictureComponent</code> requires a <code>ProfileComponent</code> to me mixed in, so that it can import the query language features from the profile:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/paradox/samples/slick-multidb/src/main/scala/cake/PictureComponent.scala#L8-L9" target="_blank" title="Go to snippet source">source</a><code class="language-scala">trait PictureComponent { this: ProfileComponent =&gt;
  import profile.api._</code></pre>
<p>Using the imported features, <code>PictureComponent</code> provides definitions and methods for working with <code>Picture</code> objects in the database. <code>UserComponent</code> does the same for <code>User</code> entities. In addition to <code>ProfileComponent</code> it also requires <code>PictureComponent</code>:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/paradox/samples/slick-multidb/src/main/scala/cake/UserComponent.scala#L8-L9" target="_blank" title="Go to snippet source">source</a><code class="language-scala">trait UserComponent { this: ProfileComponent with PictureComponent =&gt;
  import profile.api._</code></pre>
<p>The <code>PictureComponent</code> dependency allows <code>UserComponent</code> to insert a new <code>Picture</code> when needed:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/paradox/samples/slick-multidb/src/main/scala/cake/UserComponent.scala#L25-L27" target="_blank" title="Go to snippet source">source</a><code class="language-scala">pic &lt;-
  if(user.picture.id.isEmpty) insert(user.picture)
  else DBIO.successful(user.picture)</code></pre>
<p>We put all slices of the cake together in <code>DAL.scala</code>. The <code>DAL</code> class inherits from all components and adds the missing profile through a field in the constructor:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/slick/slick/tree/main/doc/paradox/samples/slick-multidb/src/main/scala/cake/DAL.scala" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import slick.jdbc.JdbcProfile

/** The Data Access Layer contains all components and a profile */
class DAL(val profile: JdbcProfile)
      extends UserComponent with PictureComponent with ProfileComponent {
  import profile.api._

  def create =
    (users.schema ++ pictures.schema).create
}</code></pre>
<p>This is also a good place to add functionality that affects all components, like the <code>create</code> method.</p>
<div class="source-github">
The source code for this page can be found <a href="https://github.com/slick/slick/tree/main/doc/paradox/database.md">here</a>.
</div>

<div class="nav-next">
<p><strong>Next:</strong> <a href="dbio.html">Database I/O Actions</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">On this page:</div>
<div class="nav-toc">
<ul>
  <li><a href="database.html#database-configuration" class="header">Database Configuration</a>
  <ul>
    <li><a href="database.html#using-typesafe-config" class="header">Using Typesafe Config</a></li>
    <li><a href="database.html#using-a-jdbc-url" class="header">Using a JDBC URL</a></li>
    <li><a href="database.html#using-a-database-url" class="header">Using a Database URL</a></li>
    <li><a href="database.html#using-a-datasource" class="header">Using a DataSource</a></li>
    <li><a href="database.html#using-a-jndi-name" class="header">Using a JNDI Name</a></li>
    <li><a href="database.html#database-thread-pool" class="header">Database thread pool</a></li>
    <li><a href="database.html#connection-pools" class="header">Connection pools</a></li>
    <li><a href="database.html#databaseconfig" class="header">DatabaseConfig</a></li>
    <li><a href="database.html#other-multi-db-patterns" class="header">Other Multi-DB Patterns</a></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2023</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="js/magellan.js"></script>
<script type="text/javascript" src="js/versions.js"></script>

<style type="text/css">@import "lib/prettify/prettify.css";</style>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>
<script type="text/javascript">jQuery(function(jq){initOldVersionWarnings(jq, '3.5.0-pre.114.9f775441', '')});</script>


</html>
